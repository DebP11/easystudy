<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Sign In | Sign Up</title>

<!-- Google Font -->
<link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">
<!-- Font Awesome for Google icon -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

<style>
  body {
    margin: 0;
    font-family: 'Poppins', sans-serif;
    background: #0F172A;
    color: #E5E7EB;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
  }

  .auth-box {
    background: #1E293B;
    padding: 30px 25px;
    width: 350px;
    border-radius: 12px;
  }

  h2 {
    text-align: center;
    color: #3B82F6;
    margin-bottom: 20px;
  }

  input, button {
    width: 100%;
    padding: 12px;
    margin-top: 10px;
    border-radius: 6px;
    border: none;
    box-sizing: border-box;
    font-size: 1rem;
  }

  button {
    cursor: pointer;
  }

  .switch {
    margin-top: 12px;
    text-align: center;
    color: #60A5FA;
    cursor: pointer;
    font-size: 0.9rem;
  }

  .hidden {
    display: none;
  }

  .social-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    margin-top: 10px;
    background: #DB4437; /* Google Red */
    color: white;
    font-weight: 500;
  }
</style>
</head>

<body>

<div class="auth-box">

  <!-- SIGN IN -->
  <div id="signIn">
    <h2>Sign In</h2>
    <input type="email" id="signin-email" placeholder="Email">
    <input type="password" id="signin-password" placeholder="Password">
    <button id="signInBtn">Sign In</button>
    <button id="googleSignInBtn" class="social-btn"><i class="fab fa-google"></i> Sign in with Google</button>
    <div class="switch" onclick="showSignUp()">Donâ€™t have an account? Sign Up</div>
  </div>

  <!-- SIGN UP -->
  <div id="signUp" class="hidden">
    <h2>Sign Up</h2>
    <input type="text" id="signup-name" placeholder="Name">
    <input type="email" id="signup-email" placeholder="Email">
    <input type="password" id="signup-password" placeholder="Password">
    <button id="signUpBtn">Create Account</button>
    <button id="googleSignUpBtn" class="social-btn"><i class="fab fa-google"></i> Sign up with Google</button>
    <div class="switch" onclick="showSignIn()">Already have an account? Sign In</div>
  </div>

</div>

<!-- Firebase Scripts -->
<script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-firestore-compat.js"></script>

<script>
 // Firebase Config
  const firebaseConfig = {
  apiKey: "AIzaSyBMEmLkJ8_-A1iSD_IF2NccOJHdcRm_Lug",
  authDomain: "study-2f23d.firebaseapp.com",
  projectId: "study-2f23d",
  storageBucket: "study-2f23d.firebasestorage.app",
  messagingSenderId: "213003244292",
  appId: "1:213003244292:web:ef994cb72bc3d265037651",
  measurementId: "G-WNCK3CT1V2"
};


  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.firestore();

  function showSignUp() {
    document.getElementById("signIn").classList.add("hidden");
    document.getElementById("signUp").classList.remove("hidden");
  }

  function showSignIn() {
    document.getElementById("signUp").classList.add("hidden");
    document.getElementById("signIn").classList.remove("hidden");
  }

  // Sign Up with Email
  document.getElementById("signUpBtn").addEventListener("click", () => {
    const email = document.getElementById("signup-email").value;
    const password = document.getElementById("signup-password").value;
    const name = document.getElementById("signup-name").value;

    if (!name) return alert("Please enter your name");

    auth.createUserWithEmailAndPassword(email, password)
      .then(userCredential => {
        const user = userCredential.user;
        user.updateProfile({ displayName: name }).then(() => {
          // Save user to Firestore
          db.collection("users").doc(user.email).set({
            name: name,
            email: user.email
          }).then(() => {
            alert("Account created and saved to Firestore! Welcome " + name);
            location.href = "index.html";
          });
        });
      })
      .catch(error => alert(error.message));
  });

  // Sign In with Email
  document.getElementById("signInBtn").addEventListener("click", () => {
    const email = document.getElementById("signin-email").value;
    const password = document.getElementById("signin-password").value;

    auth.signInWithEmailAndPassword(email, password)
      .then(userCredential => {
        alert("Welcome back " + (userCredential.user.displayName || userCredential.user.email));
        location.href = "index.html";
      })
      .catch(error => alert(error.message));
  });

  // Google Sign In / Sign Up
  function googleAuth() {
    const provider = new firebase.auth.GoogleAuthProvider();
    auth.signInWithPopup(provider)
      .then(result => {
        const user = result.user;
        // Save to Firestore
        db.collection("users").doc(user.email).set({
          name: user.displayName,
          email: user.email
        }, { merge: true }) // merge true avoids overwriting existing fields
        .then(() => {
          alert("Signed in with Google! Welcome " + user.displayName);
          location.href = "index.html";
        });
      })
      .catch(error => alert(error.message));
  }

  document.getElementById("googleSignInBtn").addEventListener("click", googleAuth);
  document.getElementById("googleSignUpBtn").addEventListener("click", googleAuth);

</script>
</body>
</html>
